[debug] [2025-03-30T07:21:57.519Z] ----------------------------------------------------------------------
[debug] [2025-03-30T07:21:57.523Z] Command:       C:\Program Files\nodejs\node.exe C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\bin\firebase.js deploy --only functions --debug --project ibotaniq
[debug] [2025-03-30T07:21:57.523Z] CLI Version:   14.0.1
[debug] [2025-03-30T07:21:57.523Z] Platform:      win32
[debug] [2025-03-30T07:21:57.523Z] Node Version:  v20.11.1
[debug] [2025-03-30T07:21:57.523Z] Time:          Sun Mar 30 2025 09:21:57 GMT+0200 (středoevropský letní čas)
[debug] [2025-03-30T07:21:57.524Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-03-30T07:21:57.783Z] Object "/functions" in "firebase.json" has unknown property: {"additionalProperty":"deploy"}
[debug] [2025-03-30T07:21:57.785Z] Field "/functions" in "firebase.json" is possibly invalid: must be array
[debug] [2025-03-30T07:21:57.785Z] Field "/functions" in "firebase.json" is possibly invalid: must match a schema in anyOf
[debug] [2025-03-30T07:21:57.791Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-03-30T07:21:57.791Z] > authorizing via signed-in user (pavlasplichal@gmail.com)
[debug] [2025-03-30T07:21:57.792Z] [iam] checking project ibotaniq for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]
[debug] [2025-03-30T07:21:57.794Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:21:57.795Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:21:57.798Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions [none]
[debug] [2025-03-30T07:21:57.798Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-30T07:21:57.799Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-03-30T07:21:58.820Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions 200
[debug] [2025-03-30T07:21:58.822Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-03-30T07:21:58.824Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:21:58.824Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:21:58.825Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/ibotaniq/serviceAccounts/ibotaniq@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2025-03-30T07:21:58.826Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/ibotaniq/serviceAccounts/ibotaniq@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2025-03-30T07:21:59.834Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/ibotaniq/serviceAccounts/ibotaniq@appspot.gserviceaccount.com:testIamPermissions 200
[debug] [2025-03-30T07:21:59.835Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/ibotaniq/serviceAccounts/ibotaniq@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[info] 
[info] === Deploying to 'ibotaniq'...
[info] 
[info] i  deploying functions 
[debug] [2025-03-30T07:21:59.847Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:21:59.848Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:21:59.849Z] >>> [apiv2][query] GET https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq [none]
[debug] [2025-03-30T07:22:00.132Z] <<< [apiv2][status] GET https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq 200
[debug] [2025-03-30T07:22:00.133Z] <<< [apiv2][body] GET https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq {"projectNumber":"349395673351","projectId":"ibotaniq","lifecycleState":"ACTIVE","name":"iBotaniQ","labels":{"firebase":"enabled","firebase-core":"disabled"},"createTime":"2025-03-15T19:55:18.615791Z"}
[info] i  functions: preparing codebase default for deployment 
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[debug] [2025-03-30T07:22:00.138Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:22:00.140Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:22:00.141Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:22:00.141Z] Checked if tokens are valid: true, expires at: 1743321625082
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[debug] [2025-03-30T07:22:00.144Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:22:00.145Z] Checked if tokens are valid: true, expires at: 1743321625082
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2025-03-30T07:22:00.146Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:22:00.147Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:22:00.149Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudfunctions.googleapis.com [none]
[debug] [2025-03-30T07:22:00.150Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudfunctions.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-30T07:22:00.154Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/runtimeconfig.googleapis.com [none]
[debug] [2025-03-30T07:22:00.155Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/runtimeconfig.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-30T07:22:00.160Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudbuild.googleapis.com [none]
[debug] [2025-03-30T07:22:00.160Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudbuild.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-30T07:22:00.163Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/artifactregistry.googleapis.com [none]
[debug] [2025-03-30T07:22:00.164Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/artifactregistry.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-30T07:22:01.454Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudfunctions.googleapis.com 200
[debug] [2025-03-30T07:22:01.455Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudfunctions.googleapis.com [omitted]
[info] +  functions: required API cloudfunctions.googleapis.com is enabled 
[debug] [2025-03-30T07:22:01.459Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/artifactregistry.googleapis.com 200
[debug] [2025-03-30T07:22:01.460Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/artifactregistry.googleapis.com [omitted]
[info] +  artifactregistry: required API artifactregistry.googleapis.com is enabled 
[debug] [2025-03-30T07:22:01.466Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/runtimeconfig.googleapis.com 200
[debug] [2025-03-30T07:22:01.467Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/runtimeconfig.googleapis.com [omitted]
[debug] [2025-03-30T07:22:01.476Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudbuild.googleapis.com 200
[debug] [2025-03-30T07:22:01.477Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudbuild.googleapis.com [omitted]
[info] +  functions: required API cloudbuild.googleapis.com is enabled 
[debug] [2025-03-30T07:22:01.480Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:22:01.481Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:22:01.482Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/ibotaniq/adminSdkConfig [none]
[debug] [2025-03-30T07:22:01.898Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/ibotaniq/adminSdkConfig 200
[debug] [2025-03-30T07:22:01.899Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/ibotaniq/adminSdkConfig {"projectId":"ibotaniq","storageBucket":"ibotaniq.firebasestorage.app"}
[debug] [2025-03-30T07:22:01.901Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:22:01.902Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:22:01.903Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs [none]
[debug] [2025-03-30T07:22:02.388Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs 200
[debug] [2025-03-30T07:22:02.389Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs {"configs":[{"name":"projects/ibotaniq/configs/mongodb"},{"name":"projects/ibotaniq/configs/app"}]}
[debug] [2025-03-30T07:22:02.391Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:22:02.392Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:22:02.393Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:22:02.394Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:22:02.395Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables [none]
[debug] [2025-03-30T07:22:02.398Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/app/variables [none]
[debug] [2025-03-30T07:22:02.798Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/app/variables 200
[debug] [2025-03-30T07:22:02.800Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/app/variables {}
[debug] [2025-03-30T07:22:02.801Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables 200
[debug] [2025-03-30T07:22:02.802Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables {"variables":[{"name":"projects/ibotaniq/configs/mongodb/variables/uri","updateTime":"2025-03-28T10:42:12.966146213Z"}]}
[debug] [2025-03-30T07:22:02.803Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:22:02.804Z] Checked if tokens are valid: true, expires at: 1743321625082
[debug] [2025-03-30T07:22:02.805Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables/uri [none]
[debug] [2025-03-30T07:22:03.109Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables/uri 200
[debug] [2025-03-30T07:22:03.110Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables/uri {"name":"projects/ibotaniq/configs/mongodb/variables/uri","updateTime":"2025-03-28T10:42:12.966146213Z","text":"mongodb+srv://pavlasplichal:novy22projekt@cluster0.dplz2.mongodb.net/malina?retryWrites=true&w=majority"}
[debug] [2025-03-30T07:22:03.116Z] Validating nodejs source
[warn] !  functions: Runtime Node.js 18 will be deprecated on 2025-04-30 and will be decommissioned on 2025-10-31, after which you will not be able to deploy without upgrading. Consider upgrading now to avoid disruption. See https://cloud.google.com/functions/docs/runtime-support for full details on the lifecycle policy 
[debug] [2025-03-30T07:22:05.141Z] > [functions] package.json contents: {
  "name": "functions",
  "version": "1.0.0",
  "main": "index.js",
  "scripts": {
    "start": "firebase emulators:start",
    "deploy": "firebase deploy --only functions"
  },
  "engines": {
    "node": "18"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "cors": "^2.8.5",
    "dotenv": "^16.4.7",
    "express": "^4.21.2",
    "firebase-admin": "^11.0.1",
    "firebase-functions": "^6.3.2",
    "joi": "^17.13.3",
    "mongoose": "^8.13.0"
  }
}
[debug] [2025-03-30T07:22:05.143Z] Building nodejs source
[info] i  functions: Loading and analyzing source code for codebase default to determine what to deploy 
[debug] [2025-03-30T07:22:05.146Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-03-30T07:22:05.160Z] Found firebase-functions binary at 'C:\Users\splic\ukol-iot\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8654

[error] TypeError: setGlobalOptions is not a function
    at Object.<anonymous> (C:\Users\splic\ukol-iot\functions\index.js:15:1)
    at Module._compile (node:internal/modules/cjs/loader:1376:14)
    at Module._extensions..js (node:internal/modules/cjs/loader:1435:10)
    at Module.load (node:internal/modules/cjs/loader:1207:32)
    at Module._load (node:internal/modules/cjs/loader:1023:12)
    at Module.require (node:internal/modules/cjs/loader:1235:19)
    at require (node:internal/modules/helpers:176:18)
    at loadModule (C:\Users\splic\ukol-iot\functions\node_modules\firebase-functions\lib\runtime\loader.js:40:16)
    at loadStack (C:\Users\splic\ukol-iot\functions\node_modules\firebase-functions\lib\runtime\loader.js:157:23)
    at C:\Users\splic\ukol-iot\functions\node_modules\firebase-functions\lib\bin\firebase-functions.js:56:56

[debug] [2025-03-30T07:22:06.315Z] Got response code 400; body Failed to generate manifest from function source: TypeError: setGlobalOptions is not a function
[error] 
[error] Error: Functions codebase could not be analyzed successfully. It may have a syntax or runtime error
[debug] [2025-03-30T07:45:45.247Z] ----------------------------------------------------------------------
[debug] [2025-03-30T07:45:45.250Z] Command:       C:\Program Files\nodejs\node.exe C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\bin\firebase.js deploy --only functions --project ibotaniq
[debug] [2025-03-30T07:45:45.250Z] CLI Version:   14.0.1
[debug] [2025-03-30T07:45:45.250Z] Platform:      win32
[debug] [2025-03-30T07:45:45.250Z] Node Version:  v20.11.1
[debug] [2025-03-30T07:45:45.250Z] Time:          Sun Mar 30 2025 09:45:45 GMT+0200 (středoevropský letní čas)
[debug] [2025-03-30T07:45:45.251Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-03-30T07:45:45.401Z] Object "/functions" in "firebase.json" has unknown property: {"additionalProperty":"deploy"}
[debug] [2025-03-30T07:45:45.401Z] Field "/functions" in "firebase.json" is possibly invalid: must be array
[debug] [2025-03-30T07:45:45.401Z] Field "/functions" in "firebase.json" is possibly invalid: must match a schema in anyOf
[debug] [2025-03-30T07:45:45.405Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-03-30T07:45:45.405Z] > authorizing via signed-in user (pavlasplichal@gmail.com)
[debug] [2025-03-30T07:45:45.405Z] [iam] checking project ibotaniq for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]
[debug] [2025-03-30T07:45:45.406Z] Checked if tokens are valid: false, expires at: 1743321625082
[debug] [2025-03-30T07:45:45.406Z] Checked if tokens are valid: false, expires at: 1743321625082
[debug] [2025-03-30T07:45:45.406Z] > refreshing access token with scopes: []
[debug] [2025-03-30T07:45:45.408Z] >>> [apiv2][query] POST https://www.googleapis.com/oauth2/v3/token [none]
[debug] [2025-03-30T07:45:45.408Z] >>> [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2025-03-30T07:45:45.658Z] <<< [apiv2][status] POST https://www.googleapis.com/oauth2/v3/token 200
[debug] [2025-03-30T07:45:45.658Z] <<< [apiv2][body] POST https://www.googleapis.com/oauth2/v3/token [omitted]
[debug] [2025-03-30T07:45:45.665Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions [none]
[debug] [2025-03-30T07:45:45.665Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-30T07:45:45.665Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-03-30T07:45:46.575Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions 200
[debug] [2025-03-30T07:45:46.576Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-03-30T07:45:46.576Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:46.576Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:46.576Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/ibotaniq/serviceAccounts/ibotaniq@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2025-03-30T07:45:46.576Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/ibotaniq/serviceAccounts/ibotaniq@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2025-03-30T07:45:47.447Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/ibotaniq/serviceAccounts/ibotaniq@appspot.gserviceaccount.com:testIamPermissions 200
[debug] [2025-03-30T07:45:47.447Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/ibotaniq/serviceAccounts/ibotaniq@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[info] 
[info] === Deploying to 'ibotaniq'...
[info] 
[info] i  deploying functions 
[debug] [2025-03-30T07:45:47.450Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:47.450Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:47.450Z] >>> [apiv2][query] GET https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq [none]
[debug] [2025-03-30T07:45:47.693Z] <<< [apiv2][status] GET https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq 200
[debug] [2025-03-30T07:45:47.694Z] <<< [apiv2][body] GET https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq {"projectNumber":"349395673351","projectId":"ibotaniq","lifecycleState":"ACTIVE","name":"iBotaniQ","labels":{"firebase":"enabled","firebase-core":"disabled"},"createTime":"2025-03-15T19:55:18.615791Z"}
[info] i  functions: preparing codebase default for deployment 
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[debug] [2025-03-30T07:45:47.697Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:47.698Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:47.698Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:47.698Z] Checked if tokens are valid: true, expires at: 1743324344658
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[debug] [2025-03-30T07:45:47.698Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:47.698Z] Checked if tokens are valid: true, expires at: 1743324344658
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2025-03-30T07:45:47.699Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:47.699Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:47.699Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudfunctions.googleapis.com [none]
[debug] [2025-03-30T07:45:47.699Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudfunctions.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-30T07:45:47.700Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/runtimeconfig.googleapis.com [none]
[debug] [2025-03-30T07:45:47.700Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/runtimeconfig.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-30T07:45:47.700Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudbuild.googleapis.com [none]
[debug] [2025-03-30T07:45:47.700Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudbuild.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-30T07:45:47.701Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/artifactregistry.googleapis.com [none]
[debug] [2025-03-30T07:45:47.701Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/artifactregistry.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-30T07:45:48.760Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/runtimeconfig.googleapis.com 200
[debug] [2025-03-30T07:45:48.760Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/runtimeconfig.googleapis.com [omitted]
[debug] [2025-03-30T07:45:48.777Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudfunctions.googleapis.com 200
[debug] [2025-03-30T07:45:48.777Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudfunctions.googleapis.com [omitted]
[info] +  functions: required API cloudfunctions.googleapis.com is enabled 
[debug] [2025-03-30T07:45:48.779Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/artifactregistry.googleapis.com 200
[debug] [2025-03-30T07:45:48.779Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/artifactregistry.googleapis.com [omitted]
[info] +  artifactregistry: required API artifactregistry.googleapis.com is enabled 
[debug] [2025-03-30T07:45:48.780Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudbuild.googleapis.com 200
[debug] [2025-03-30T07:45:48.781Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudbuild.googleapis.com [omitted]
[info] +  functions: required API cloudbuild.googleapis.com is enabled 
[debug] [2025-03-30T07:45:48.781Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:48.781Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:48.781Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/ibotaniq/adminSdkConfig [none]
[debug] [2025-03-30T07:45:49.195Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/ibotaniq/adminSdkConfig 200
[debug] [2025-03-30T07:45:49.195Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/ibotaniq/adminSdkConfig {"projectId":"ibotaniq","storageBucket":"ibotaniq.firebasestorage.app"}
[debug] [2025-03-30T07:45:49.195Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:49.195Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:49.195Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs [none]
[debug] [2025-03-30T07:45:49.584Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs 200
[debug] [2025-03-30T07:45:49.584Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs {"configs":[{"name":"projects/ibotaniq/configs/app"},{"name":"projects/ibotaniq/configs/mongodb"}]}
[debug] [2025-03-30T07:45:49.585Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:49.585Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:49.585Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:49.585Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:49.586Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/app/variables [none]
[debug] [2025-03-30T07:45:49.587Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables [none]
[debug] [2025-03-30T07:45:49.850Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/app/variables 200
[debug] [2025-03-30T07:45:49.850Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/app/variables {}
[debug] [2025-03-30T07:45:49.969Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables 200
[debug] [2025-03-30T07:45:49.970Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables {"variables":[{"name":"projects/ibotaniq/configs/mongodb/variables/uri","updateTime":"2025-03-28T10:42:12.966146213Z"}]}
[debug] [2025-03-30T07:45:49.970Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:49.971Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:45:49.971Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables/uri [none]
[debug] [2025-03-30T07:45:50.217Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables/uri 200
[debug] [2025-03-30T07:45:50.217Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables/uri {"name":"projects/ibotaniq/configs/mongodb/variables/uri","updateTime":"2025-03-28T10:42:12.966146213Z","text":"mongodb+srv://pavlasplichal:novy22projekt@cluster0.dplz2.mongodb.net/malina?retryWrites=true&w=majority"}
[debug] [2025-03-30T07:45:50.218Z] Validating nodejs source
[warn] !  functions: Runtime Node.js 18 will be deprecated on 2025-04-30 and will be decommissioned on 2025-10-31, after which you will not be able to deploy without upgrading. Consider upgrading now to avoid disruption. See https://cloud.google.com/functions/docs/runtime-support for full details on the lifecycle policy 
[debug] [2025-03-30T07:45:51.506Z] > [functions] package.json contents: {
  "name": "functions",
  "version": "1.0.0",
  "main": "index.js",
  "scripts": {
    "start": "firebase emulators:start",
    "deploy": "firebase deploy --only functions"
  },
  "engines": {
    "node": "18"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "cors": "^2.8.5",
    "dotenv": "^16.4.7",
    "express": "^4.21.2",
    "firebase-admin": "^11.0.1",
    "firebase-functions": "^4.3.0",
    "joi": "^17.13.3",
    "mongoose": "^8.13.0"
  }
}
[debug] [2025-03-30T07:45:51.507Z] Building nodejs source
[info] i  functions: Loading and analyzing source code for codebase default to determine what to deploy 
[debug] [2025-03-30T07:45:51.508Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-03-30T07:45:51.513Z] Found firebase-functions binary at 'C:\Users\splic\ukol-iot\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8406

[error] (node:5448) [MONGODB DRIVER] Warning: useNewUrlParser is a deprecated option: useNewUrlParser has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
(Use `node --trace-warnings ...` to show where the warning was created)
(node:5448) [MONGODB DRIVER] Warning: useUnifiedTopology is a deprecated option: useUnifiedTopology has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version

[debug] [2025-03-30T07:45:52.293Z] Got response from /__/functions.yaml {"endpoints":{"api":{"timeoutSeconds":60,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":80,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","region":["us-central1"],"labels":{},"httpsTrigger":{},"entryPoint":"api"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[info] MongoDB connected

[info] i  extensions: ensuring required API firebaseextensions.googleapis.com is enabled... 
[debug] [2025-03-30T07:46:02.315Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:02.315Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:02.316Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/firebaseextensions.googleapis.com [none]
[debug] [2025-03-30T07:46:02.316Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/firebaseextensions.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-30T07:46:03.340Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/firebaseextensions.googleapis.com 200
[debug] [2025-03-30T07:46:03.340Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/firebaseextensions.googleapis.com [omitted]
[info] +  extensions: required API firebaseextensions.googleapis.com is enabled 
[debug] [2025-03-30T07:46:03.341Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-03-30T07:46:03.341Z] > authorizing via signed-in user (pavlasplichal@gmail.com)
[debug] [2025-03-30T07:46:03.341Z] [iam] checking project ibotaniq for permissions ["firebase.projects.get","firebaseextensions.instances.list"]
[debug] [2025-03-30T07:46:03.341Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:03.341Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:03.341Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions [none]
[debug] [2025-03-30T07:46:03.341Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-30T07:46:03.341Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions {"permissions":["firebase.projects.get","firebaseextensions.instances.list"]}
[debug] [2025-03-30T07:46:04.171Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions 200
[debug] [2025-03-30T07:46:04.171Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions {"permissions":["firebase.projects.get","firebaseextensions.instances.list"]}
[debug] [2025-03-30T07:46:04.172Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:04.172Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:04.172Z] >>> [apiv2][query] GET https://firebaseextensions.googleapis.com/v1beta/projects/ibotaniq/instances pageSize=100&pageToken=
[debug] [2025-03-30T07:46:05.233Z] <<< [apiv2][status] GET https://firebaseextensions.googleapis.com/v1beta/projects/ibotaniq/instances 200
[debug] [2025-03-30T07:46:05.233Z] <<< [apiv2][body] GET https://firebaseextensions.googleapis.com/v1beta/projects/ibotaniq/instances {}
[info] i  functions: Loaded environment variables from .env. 
[info] i  functions: preparing functions directory for uploading... 
[info] i  functions: packaged C:\Users\splic\ukol-iot\functions (42.43 KB) for uploading 
[debug] [2025-03-30T07:46:05.272Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:05.272Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:05.272Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/projects/ibotaniq/locations/-/functions [none]
[debug] [2025-03-30T07:46:06.055Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/projects/ibotaniq/locations/-/functions 200
[debug] [2025-03-30T07:46:06.055Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/projects/ibotaniq/locations/-/functions {}
[debug] [2025-03-30T07:46:06.055Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:06.055Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:06.055Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/-/functions filter=environment%3D%22GEN_2%22
[debug] [2025-03-30T07:46:07.099Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/-/functions 200
[debug] [2025-03-30T07:46:07.101Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/-/functions {"functions":[{"name":"projects/ibotaniq/locations/us-central1/functions/api","buildConfig":{"build":"projects/349395673351/locations/us-central1/builds/e83828d0-a3f6-49e1-bbfb-8596ac88866a","runtime":"nodejs18","entryPoint":"api","source":{"storageSource":{"bucket":"gcf-v2-sources-349395673351-us-central1","object":"api/function-source.zip","generation":"1743159082418767"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts","serviceAccount":"projects/ibotaniq/serviceAccounts/349395673351-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/ibotaniq/locations/us-central1/services/api","timeoutSeconds":60,"environmentVariables":{"FIREBASE_CONFIG":"{\"projectId\":\"ibotaniq\",\"storageBucket\":\"ibotaniq.firebasestorage.app\"}","GCLOUD_PROJECT":"ibotaniq","EVENTARC_CLOUD_EVENT_SOURCE":"projects/ibotaniq/locations/us-central1/services/api","FUNCTION_TARGET":"api","LOG_EXECUTION_ID":"true"},"maxInstanceCount":100,"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"349395673351-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"revision":"api-00001-rex","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","updateTime":"2025-03-28T10:52:28.430353341Z","labels":{"deployment-tool":"cli-firebase","firebase-functions-hash":"3516fa3b675679f37ff5c115ea0b9b0c201999bf"},"environment":"GEN_2","url":"https://us-central1-ibotaniq.cloudfunctions.net/api","createTime":"2025-03-28T10:18:37.827524970Z","satisfiesPzi":true}]}
[info] i  functions: ensuring required API run.googleapis.com is enabled... 
[debug] [2025-03-30T07:46:07.107Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:07.107Z] Checked if tokens are valid: true, expires at: 1743324344658
[info] i  functions: ensuring required API eventarc.googleapis.com is enabled... 
[debug] [2025-03-30T07:46:07.108Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:07.108Z] Checked if tokens are valid: true, expires at: 1743324344658
[info] i  functions: ensuring required API pubsub.googleapis.com is enabled... 
[debug] [2025-03-30T07:46:07.108Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:07.109Z] Checked if tokens are valid: true, expires at: 1743324344658
[info] i  functions: ensuring required API storage.googleapis.com is enabled... 
[debug] [2025-03-30T07:46:07.109Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:07.109Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:07.110Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/run.googleapis.com [none]
[debug] [2025-03-30T07:46:07.110Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/run.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-30T07:46:07.110Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/eventarc.googleapis.com [none]
[debug] [2025-03-30T07:46:07.110Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/eventarc.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-30T07:46:07.111Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/pubsub.googleapis.com [none]
[debug] [2025-03-30T07:46:07.111Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/pubsub.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-30T07:46:07.112Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/storage.googleapis.com [none]
[debug] [2025-03-30T07:46:07.112Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/storage.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-30T07:46:07.491Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/run.googleapis.com 200
[debug] [2025-03-30T07:46:07.491Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/run.googleapis.com [omitted]
[info] +  functions: required API run.googleapis.com is enabled 
[debug] [2025-03-30T07:46:08.129Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/pubsub.googleapis.com 200
[debug] [2025-03-30T07:46:08.129Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/pubsub.googleapis.com [omitted]
[info] +  functions: required API pubsub.googleapis.com is enabled 
[debug] [2025-03-30T07:46:08.142Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/eventarc.googleapis.com 200
[debug] [2025-03-30T07:46:08.142Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/eventarc.googleapis.com [omitted]
[info] +  functions: required API eventarc.googleapis.com is enabled 
[debug] [2025-03-30T07:46:08.160Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/storage.googleapis.com 200
[debug] [2025-03-30T07:46:08.161Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/storage.googleapis.com [omitted]
[info] +  functions: required API storage.googleapis.com is enabled 
[info] i  functions: generating the service identity for pubsub.googleapis.com... 
[debug] [2025-03-30T07:46:08.162Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:08.162Z] Checked if tokens are valid: true, expires at: 1743324344658
[info] i  functions: generating the service identity for eventarc.googleapis.com... 
[debug] [2025-03-30T07:46:08.162Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:08.162Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:08.162Z] >>> [apiv2][query] POST https://serviceusage.googleapis.com/v1beta1/projects/349395673351/services/pubsub.googleapis.com:generateServiceIdentity [none]
[debug] [2025-03-30T07:46:08.163Z] >>> [apiv2][query] POST https://serviceusage.googleapis.com/v1beta1/projects/349395673351/services/eventarc.googleapis.com:generateServiceIdentity [none]
[debug] [2025-03-30T07:46:09.090Z] <<< [apiv2][status] POST https://serviceusage.googleapis.com/v1beta1/projects/349395673351/services/pubsub.googleapis.com:generateServiceIdentity 200
[debug] [2025-03-30T07:46:09.090Z] <<< [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/349395673351/services/pubsub.googleapis.com:generateServiceIdentity {"name":"operations/finished.DONE_OPERATION","done":true,"response":{"@type":"type.googleapis.com/google.api.serviceusage.v1beta1.ServiceIdentity","email":"service-349395673351@gcp-sa-pubsub.iam.gserviceaccount.com","uniqueId":"107806887384018536333"}}
[debug] [2025-03-30T07:46:09.126Z] <<< [apiv2][status] POST https://serviceusage.googleapis.com/v1beta1/projects/349395673351/services/eventarc.googleapis.com:generateServiceIdentity 200
[debug] [2025-03-30T07:46:09.126Z] <<< [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/349395673351/services/eventarc.googleapis.com:generateServiceIdentity {"name":"operations/finished.DONE_OPERATION","done":true,"response":{"@type":"type.googleapis.com/google.api.serviceusage.v1beta1.ServiceIdentity","email":"service-349395673351@gcp-sa-eventarc.iam.gserviceaccount.com","uniqueId":"118401887025608679041"}}
[debug] [2025-03-30T07:46:09.130Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:09.130Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:09.130Z] >>> [apiv2][query] GET https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq [none]
[debug] [2025-03-30T07:46:09.369Z] <<< [apiv2][status] GET https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq 200
[debug] [2025-03-30T07:46:09.370Z] <<< [apiv2][body] GET https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq {"projectNumber":"349395673351","projectId":"ibotaniq","lifecycleState":"ACTIVE","name":"iBotaniQ","labels":{"firebase":"enabled","firebase-core":"disabled"},"createTime":"2025-03-15T19:55:18.615791Z"}
[debug] [2025-03-30T07:46:09.372Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:09.372Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:09.372Z] >>> [apiv2][query] GET https://cloudbilling.googleapis.com/v1/projects/ibotaniq/billingInfo [none]
[debug] [2025-03-30T07:46:10.304Z] <<< [apiv2][status] GET https://cloudbilling.googleapis.com/v1/projects/ibotaniq/billingInfo 200
[debug] [2025-03-30T07:46:10.304Z] <<< [apiv2][body] GET https://cloudbilling.googleapis.com/v1/projects/ibotaniq/billingInfo {"name":"projects/ibotaniq/billingInfo","projectId":"ibotaniq","billingAccountName":"billingAccounts/01F2AB-41BBCC-E41816","billingEnabled":true}
[debug] [2025-03-30T07:46:10.307Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:10.308Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:10.308Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/functions:generateUploadUrl [none]
[debug] [2025-03-30T07:46:11.130Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/functions:generateUploadUrl 200
[debug] [2025-03-30T07:46:11.130Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/functions:generateUploadUrl {"uploadUrl":"https://storage.googleapis.com/gcf-v2-uploads-349395673351.us-central1.cloudfunctions.appspot.com/255a90d2-2462-42da-8983-fcc9aa65505a.zip?GoogleAccessId=service-349395673351@gcf-admin-robot.iam.gserviceaccount.com&Expires=1743322571&Signature=QMFixO453QUmtGOMLxr7N4wsuFNbrPEvYKt0MUnugdbS%2BrZihYrv7fsree1aYa2KKuSYskDkOET1TtOtlOx8YmD7smU7yFF9aafFofLgwJdEPzsEjaxaqp7ujZg2KM%2FXzf1fxQkQaL14k2rAMdWagu%2BPKxwRPtacqvzUtdcr037T0yrqK%2F%2B8U%2FETA6k6PjPRh5YLmpxHNcL0IAUIWe9Weuja43O2SU4SkSW%2BciO%2F7sIzG8Mgl2PdCWyJCakDHpmqc3p4zbBajiI%2FxBCqJiAovZWkogqXaLtBF63g3PIZHNb7egOKazPWIbRGbw5K57N98fQ%2FG%2BYHkPJJhPmtSZui8Q%3D%3D","storageSource":{"bucket":"gcf-v2-uploads-349395673351.us-central1.cloudfunctions.appspot.com","object":"255a90d2-2462-42da-8983-fcc9aa65505a.zip"}}
[debug] [2025-03-30T07:46:11.133Z] >>> [apiv2][query] PUT https://storage.googleapis.com/gcf-v2-uploads-349395673351.us-central1.cloudfunctions.appspot.com/255a90d2-2462-42da-8983-fcc9aa65505a.zip GoogleAccessId=service-349395673351%40gcf-admin-robot.iam.gserviceaccount.com&Expires=1743322571&Signature=QMFixO453QUmtGOMLxr7N4wsuFNbrPEvYKt0MUnugdbS%2BrZihYrv7fsree1aYa2KKuSYskDkOET1TtOtlOx8YmD7smU7yFF9aafFofLgwJdEPzsEjaxaqp7ujZg2KM%2FXzf1fxQkQaL14k2rAMdWagu%2BPKxwRPtacqvzUtdcr037T0yrqK%2F%2B8U%2FETA6k6PjPRh5YLmpxHNcL0IAUIWe9Weuja43O2SU4SkSW%2BciO%2F7sIzG8Mgl2PdCWyJCakDHpmqc3p4zbBajiI%2FxBCqJiAovZWkogqXaLtBF63g3PIZHNb7egOKazPWIbRGbw5K57N98fQ%2FG%2BYHkPJJhPmtSZui8Q%3D%3D
[debug] [2025-03-30T07:46:11.133Z] >>> [apiv2][body] PUT https://storage.googleapis.com/gcf-v2-uploads-349395673351.us-central1.cloudfunctions.appspot.com/255a90d2-2462-42da-8983-fcc9aa65505a.zip [stream]
[debug] [2025-03-30T07:46:12.653Z] <<< [apiv2][status] PUT https://storage.googleapis.com/gcf-v2-uploads-349395673351.us-central1.cloudfunctions.appspot.com/255a90d2-2462-42da-8983-fcc9aa65505a.zip 200
[debug] [2025-03-30T07:46:12.653Z] <<< [apiv2][body] PUT https://storage.googleapis.com/gcf-v2-uploads-349395673351.us-central1.cloudfunctions.appspot.com/255a90d2-2462-42da-8983-fcc9aa65505a.zip [omitted]
[info] +  functions: functions folder uploaded successfully 
[info] i  functions: updating Node.js 18 (2nd Gen) function api(us-central1)... 
[debug] [2025-03-30T07:46:12.663Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:12.663Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:12.663Z] >>> [apiv2][query] PATCH https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/functions/api updateMask=name%2CbuildConfig.runtime%2CbuildConfig.entryPoint%2CbuildConfig.source.storageSource.bucket%2CbuildConfig.source.storageSource.object%2CbuildConfig.environmentVariables%2CbuildConfig.sourceToken%2CserviceConfig.environmentVariables%2CserviceConfig.ingressSettings%2CserviceConfig.timeoutSeconds%2CserviceConfig.serviceAccountEmail%2CserviceConfig.availableMemory%2CserviceConfig.minInstanceCount%2CserviceConfig.maxInstanceCount%2CserviceConfig.maxInstanceRequestConcurrency%2CserviceConfig.availableCpu%2CserviceConfig.vpcConnector%2CserviceConfig.vpcConnectorEgressSettings%2Clabels%2CbuildConfig.buildEnvironmentVariables
[debug] [2025-03-30T07:46:12.663Z] >>> [apiv2][body] PATCH https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/functions/api {"name":"projects/ibotaniq/locations/us-central1/functions/api","buildConfig":{"runtime":"nodejs18","entryPoint":"api","source":{"storageSource":{"bucket":"gcf-v2-uploads-349395673351.us-central1.cloudfunctions.appspot.com","object":"255a90d2-2462-42da-8983-fcc9aa65505a.zip"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""}},"serviceConfig":{"environmentVariables":{"APP_PORT":"5000","DB_URI":"mongodb+srv://pavlasplichal:novy22projekt@cluster0.dplz2.mongodb.net/malina?retryWrites=true&w=majority","FIREBASE_CONFIG":"{\"projectId\":\"ibotaniq\",\"storageBucket\":\"ibotaniq.firebasestorage.app\"}","GCLOUD_PROJECT":"ibotaniq","EVENTARC_CLOUD_EVENT_SOURCE":"projects/ibotaniq/locations/us-central1/services/api","FUNCTION_TARGET":"api","LOG_EXECUTION_ID":"true"},"ingressSettings":null,"timeoutSeconds":60,"serviceAccountEmail":null,"availableMemory":"256Mi","minInstanceCount":null,"maxInstanceCount":null,"maxInstanceRequestConcurrency":80,"availableCpu":"1","vpcConnector":null,"vpcConnectorEgressSettings":null},"labels":{"deployment-tool":"cli-firebase","firebase-functions-hash":"2260639d8529a91318d76047e453e57f8247cb60"}}
[debug] [2025-03-30T07:46:14.411Z] <<< [apiv2][status] PATCH https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/functions/api 200
[debug] [2025-03-30T07:46:14.411Z] <<< [apiv2][body] PATCH https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/functions/api {"name":"projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-03-30T07:46:14.558802814Z","target":"projects/ibotaniq/locations/us-central1/functions/api","verb":"update","cancelRequested":false,"apiVersion":"v2"},"done":false}
[debug] [2025-03-30T07:46:14.412Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:14.412Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:14.412Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f [none]
[debug] [2025-03-30T07:46:15.188Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f 200
[debug] [2025-03-30T07:46:15.188Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f {"name":"projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-03-30T07:46:14.558802814Z","target":"projects/ibotaniq/locations/us-central1/functions/api","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/ibotaniq/locations/us-central1/functions/api","buildConfig":{"runtime":"nodejs18","entryPoint":"api","source":{"storageSource":{"bucket":"gcf-v2-sources-349395673351-us-central1","object":"api/function-source.zip","generation":"1743320774443524"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts","serviceAccount":"projects/ibotaniq/serviceAccounts/349395673351-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/ibotaniq/locations/us-central1/services/api","timeoutSeconds":60,"environmentVariables":{"APP_PORT":"5000","DB_URI":"mongodb+srv://pavlasplichal:novy22projekt@cluster0.dplz2.mongodb.net/malina?retryWrites=true&w=majority","FIREBASE_CONFIG":"{\"projectId\":\"ibotaniq\",\"storageBucket\":\"ibotaniq.firebasestorage.app\"}","GCLOUD_PROJECT":"ibotaniq","EVENTARC_CLOUD_EVENT_SOURCE":"projects/ibotaniq/locations/us-central1/services/api","FUNCTION_TARGET":"api","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"349395673351-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"revision":"api-00001-rex","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","labels":{"deployment-tool":"cloudfunctions","firebase-functions-hash":"2260639d8529a91318d76047e453e57f8247cb60"},"environment":"GEN_2","url":"https://us-central1-ibotaniq.cloudfunctions.net/api","satisfiesPzi":true},"stages":[{"name":"BUILD","state":"NOT_STARTED","stateMessages":[{"severity":"WARNING","type":"BuildAnalysisWarning","message":"Node.js 18 is no longer supported by the Node.js community as of 30 April, 2025. Node.js 18 will be deprecated on 2025-04-30. We recommend you to upgrade to the latest version of Node.js as soon as possible."}]},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION"},"done":false}
[debug] [2025-03-30T07:46:15.700Z] [update-default-us-central1-api] Retrying task index 0
[debug] [2025-03-30T07:46:15.701Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:15.701Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:15.701Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f [none]
[debug] [2025-03-30T07:46:16.452Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f 200
[debug] [2025-03-30T07:46:16.452Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f {"name":"projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-03-30T07:46:14.558802814Z","target":"projects/ibotaniq/locations/us-central1/functions/api","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/ibotaniq/locations/us-central1/functions/api","buildConfig":{"runtime":"nodejs18","entryPoint":"api","source":{"storageSource":{"bucket":"gcf-v2-sources-349395673351-us-central1","object":"api/function-source.zip","generation":"1743320774443524"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts","serviceAccount":"projects/ibotaniq/serviceAccounts/349395673351-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/ibotaniq/locations/us-central1/services/api","timeoutSeconds":60,"environmentVariables":{"APP_PORT":"5000","DB_URI":"mongodb+srv://pavlasplichal:novy22projekt@cluster0.dplz2.mongodb.net/malina?retryWrites=true&w=majority","FIREBASE_CONFIG":"{\"projectId\":\"ibotaniq\",\"storageBucket\":\"ibotaniq.firebasestorage.app\"}","GCLOUD_PROJECT":"ibotaniq","EVENTARC_CLOUD_EVENT_SOURCE":"projects/ibotaniq/locations/us-central1/services/api","FUNCTION_TARGET":"api","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"349395673351-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"revision":"api-00001-rex","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","labels":{"deployment-tool":"cloudfunctions","firebase-functions-hash":"2260639d8529a91318d76047e453e57f8247cb60"},"environment":"GEN_2","url":"https://us-central1-ibotaniq.cloudfunctions.net/api","satisfiesPzi":true},"stages":[{"name":"BUILD","message":"Build in progress","state":"IN_PROGRESS","resource":"projects/349395673351/locations/us-central1/builds/fa1431a1-c683-4930-83b0-cc9b847c65d6","resourceUri":"https://console.cloud.google.com/cloud-build/builds;region=us-central1/fa1431a1-c683-4930-83b0-cc9b847c65d6?project=349395673351"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION","buildName":"projects/349395673351/locations/us-central1/builds/fa1431a1-c683-4930-83b0-cc9b847c65d6"},"done":false}
[debug] [2025-03-30T07:46:17.465Z] [update-default-us-central1-api] Retrying task index 0
[debug] [2025-03-30T07:46:17.466Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:17.466Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:17.466Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f [none]
[debug] [2025-03-30T07:46:18.266Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f 200
[debug] [2025-03-30T07:46:18.266Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f {"name":"projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-03-30T07:46:14.558802814Z","target":"projects/ibotaniq/locations/us-central1/functions/api","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/ibotaniq/locations/us-central1/functions/api","buildConfig":{"runtime":"nodejs18","entryPoint":"api","source":{"storageSource":{"bucket":"gcf-v2-sources-349395673351-us-central1","object":"api/function-source.zip","generation":"1743320774443524"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts","serviceAccount":"projects/ibotaniq/serviceAccounts/349395673351-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/ibotaniq/locations/us-central1/services/api","timeoutSeconds":60,"environmentVariables":{"APP_PORT":"5000","DB_URI":"mongodb+srv://pavlasplichal:novy22projekt@cluster0.dplz2.mongodb.net/malina?retryWrites=true&w=majority","FIREBASE_CONFIG":"{\"projectId\":\"ibotaniq\",\"storageBucket\":\"ibotaniq.firebasestorage.app\"}","GCLOUD_PROJECT":"ibotaniq","EVENTARC_CLOUD_EVENT_SOURCE":"projects/ibotaniq/locations/us-central1/services/api","FUNCTION_TARGET":"api","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"349395673351-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"revision":"api-00001-rex","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","labels":{"deployment-tool":"cloudfunctions","firebase-functions-hash":"2260639d8529a91318d76047e453e57f8247cb60"},"environment":"GEN_2","url":"https://us-central1-ibotaniq.cloudfunctions.net/api","satisfiesPzi":true},"stages":[{"name":"BUILD","message":"Build in progress","state":"IN_PROGRESS","resource":"projects/349395673351/locations/us-central1/builds/fa1431a1-c683-4930-83b0-cc9b847c65d6","resourceUri":"https://console.cloud.google.com/cloud-build/builds;region=us-central1/fa1431a1-c683-4930-83b0-cc9b847c65d6?project=349395673351"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION","buildName":"projects/349395673351/locations/us-central1/builds/fa1431a1-c683-4930-83b0-cc9b847c65d6"},"done":false}
[debug] [2025-03-30T07:46:20.270Z] [update-default-us-central1-api] Retrying task index 0
[debug] [2025-03-30T07:46:20.271Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:20.271Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:20.271Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f [none]
[debug] [2025-03-30T07:46:21.014Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f 200
[debug] [2025-03-30T07:46:21.014Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f {"name":"projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-03-30T07:46:14.558802814Z","target":"projects/ibotaniq/locations/us-central1/functions/api","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/ibotaniq/locations/us-central1/functions/api","buildConfig":{"runtime":"nodejs18","entryPoint":"api","source":{"storageSource":{"bucket":"gcf-v2-sources-349395673351-us-central1","object":"api/function-source.zip","generation":"1743320774443524"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts","serviceAccount":"projects/ibotaniq/serviceAccounts/349395673351-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/ibotaniq/locations/us-central1/services/api","timeoutSeconds":60,"environmentVariables":{"APP_PORT":"5000","DB_URI":"mongodb+srv://pavlasplichal:novy22projekt@cluster0.dplz2.mongodb.net/malina?retryWrites=true&w=majority","FIREBASE_CONFIG":"{\"projectId\":\"ibotaniq\",\"storageBucket\":\"ibotaniq.firebasestorage.app\"}","GCLOUD_PROJECT":"ibotaniq","EVENTARC_CLOUD_EVENT_SOURCE":"projects/ibotaniq/locations/us-central1/services/api","FUNCTION_TARGET":"api","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"349395673351-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"revision":"api-00001-rex","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","labels":{"deployment-tool":"cloudfunctions","firebase-functions-hash":"2260639d8529a91318d76047e453e57f8247cb60"},"environment":"GEN_2","url":"https://us-central1-ibotaniq.cloudfunctions.net/api","satisfiesPzi":true},"stages":[{"name":"BUILD","message":"Build in progress","state":"IN_PROGRESS","resource":"projects/349395673351/locations/us-central1/builds/fa1431a1-c683-4930-83b0-cc9b847c65d6","resourceUri":"https://console.cloud.google.com/cloud-build/builds;region=us-central1/fa1431a1-c683-4930-83b0-cc9b847c65d6?project=349395673351"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION","buildName":"projects/349395673351/locations/us-central1/builds/fa1431a1-c683-4930-83b0-cc9b847c65d6"},"done":false}
[debug] [2025-03-30T07:46:25.016Z] [update-default-us-central1-api] Retrying task index 0
[debug] [2025-03-30T07:46:25.017Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:25.017Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:25.018Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f [none]
[debug] [2025-03-30T07:46:25.762Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f 200
[debug] [2025-03-30T07:46:25.762Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f {"name":"projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-03-30T07:46:14.558802814Z","target":"projects/ibotaniq/locations/us-central1/functions/api","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/ibotaniq/locations/us-central1/functions/api","buildConfig":{"runtime":"nodejs18","entryPoint":"api","source":{"storageSource":{"bucket":"gcf-v2-sources-349395673351-us-central1","object":"api/function-source.zip","generation":"1743320774443524"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts","serviceAccount":"projects/ibotaniq/serviceAccounts/349395673351-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/ibotaniq/locations/us-central1/services/api","timeoutSeconds":60,"environmentVariables":{"APP_PORT":"5000","DB_URI":"mongodb+srv://pavlasplichal:novy22projekt@cluster0.dplz2.mongodb.net/malina?retryWrites=true&w=majority","FIREBASE_CONFIG":"{\"projectId\":\"ibotaniq\",\"storageBucket\":\"ibotaniq.firebasestorage.app\"}","GCLOUD_PROJECT":"ibotaniq","EVENTARC_CLOUD_EVENT_SOURCE":"projects/ibotaniq/locations/us-central1/services/api","FUNCTION_TARGET":"api","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"349395673351-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"revision":"api-00001-rex","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","labels":{"deployment-tool":"cloudfunctions","firebase-functions-hash":"2260639d8529a91318d76047e453e57f8247cb60"},"environment":"GEN_2","url":"https://us-central1-ibotaniq.cloudfunctions.net/api","satisfiesPzi":true},"stages":[{"name":"BUILD","message":"Build in progress","state":"IN_PROGRESS","resource":"projects/349395673351/locations/us-central1/builds/fa1431a1-c683-4930-83b0-cc9b847c65d6","resourceUri":"https://console.cloud.google.com/cloud-build/builds;region=us-central1/fa1431a1-c683-4930-83b0-cc9b847c65d6?project=349395673351"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION","buildName":"projects/349395673351/locations/us-central1/builds/fa1431a1-c683-4930-83b0-cc9b847c65d6"},"done":false}
[debug] [2025-03-30T07:46:33.775Z] [update-default-us-central1-api] Retrying task index 0
[debug] [2025-03-30T07:46:33.776Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:33.776Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:33.777Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f [none]
[debug] [2025-03-30T07:46:34.650Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f 200
[debug] [2025-03-30T07:46:34.650Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f {"name":"projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-03-30T07:46:14.558802814Z","target":"projects/ibotaniq/locations/us-central1/functions/api","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/ibotaniq/locations/us-central1/functions/api","buildConfig":{"runtime":"nodejs18","entryPoint":"api","source":{"storageSource":{"bucket":"gcf-v2-sources-349395673351-us-central1","object":"api/function-source.zip","generation":"1743320774443524"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts","serviceAccount":"projects/ibotaniq/serviceAccounts/349395673351-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/ibotaniq/locations/us-central1/services/api","timeoutSeconds":60,"environmentVariables":{"APP_PORT":"5000","DB_URI":"mongodb+srv://pavlasplichal:novy22projekt@cluster0.dplz2.mongodb.net/malina?retryWrites=true&w=majority","FIREBASE_CONFIG":"{\"projectId\":\"ibotaniq\",\"storageBucket\":\"ibotaniq.firebasestorage.app\"}","GCLOUD_PROJECT":"ibotaniq","EVENTARC_CLOUD_EVENT_SOURCE":"projects/ibotaniq/locations/us-central1/services/api","FUNCTION_TARGET":"api","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"349395673351-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"revision":"api-00001-rex","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","labels":{"deployment-tool":"cloudfunctions","firebase-functions-hash":"2260639d8529a91318d76047e453e57f8247cb60"},"environment":"GEN_2","url":"https://us-central1-ibotaniq.cloudfunctions.net/api","satisfiesPzi":true},"stages":[{"name":"BUILD","message":"Build in progress","state":"IN_PROGRESS","resource":"projects/349395673351/locations/us-central1/builds/fa1431a1-c683-4930-83b0-cc9b847c65d6","resourceUri":"https://console.cloud.google.com/cloud-build/builds;region=us-central1/fa1431a1-c683-4930-83b0-cc9b847c65d6?project=349395673351"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION","buildName":"projects/349395673351/locations/us-central1/builds/fa1431a1-c683-4930-83b0-cc9b847c65d6"},"done":false}
[debug] [2025-03-30T07:46:44.652Z] [update-default-us-central1-api] Retrying task index 0
[debug] [2025-03-30T07:46:44.653Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:44.653Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:44.653Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f [none]
[debug] [2025-03-30T07:46:45.535Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f 200
[debug] [2025-03-30T07:46:45.536Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f {"name":"projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-03-30T07:46:14.558802814Z","target":"projects/ibotaniq/locations/us-central1/functions/api","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/ibotaniq/locations/us-central1/functions/api","buildConfig":{"runtime":"nodejs18","entryPoint":"api","source":{"storageSource":{"bucket":"gcf-v2-sources-349395673351-us-central1","object":"api/function-source.zip","generation":"1743320774443524"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts","serviceAccount":"projects/ibotaniq/serviceAccounts/349395673351-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/ibotaniq/locations/us-central1/services/api","timeoutSeconds":60,"environmentVariables":{"APP_PORT":"5000","DB_URI":"mongodb+srv://pavlasplichal:novy22projekt@cluster0.dplz2.mongodb.net/malina?retryWrites=true&w=majority","FIREBASE_CONFIG":"{\"projectId\":\"ibotaniq\",\"storageBucket\":\"ibotaniq.firebasestorage.app\"}","GCLOUD_PROJECT":"ibotaniq","EVENTARC_CLOUD_EVENT_SOURCE":"projects/ibotaniq/locations/us-central1/services/api","FUNCTION_TARGET":"api","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"349395673351-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"revision":"api-00001-rex","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","labels":{"deployment-tool":"cloudfunctions","firebase-functions-hash":"2260639d8529a91318d76047e453e57f8247cb60"},"environment":"GEN_2","url":"https://us-central1-ibotaniq.cloudfunctions.net/api","satisfiesPzi":true},"stages":[{"name":"BUILD","message":"Build in progress","state":"IN_PROGRESS","resource":"projects/349395673351/locations/us-central1/builds/fa1431a1-c683-4930-83b0-cc9b847c65d6","resourceUri":"https://console.cloud.google.com/cloud-build/builds;region=us-central1/fa1431a1-c683-4930-83b0-cc9b847c65d6?project=349395673351"},{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION","buildName":"projects/349395673351/locations/us-central1/builds/fa1431a1-c683-4930-83b0-cc9b847c65d6"},"done":false}
[debug] [2025-03-30T07:46:55.548Z] [update-default-us-central1-api] Retrying task index 0
[debug] [2025-03-30T07:46:55.549Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:55.549Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:55.549Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f [none]
[debug] [2025-03-30T07:46:56.551Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f 200
[debug] [2025-03-30T07:46:56.552Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f {"name":"projects/ibotaniq/locations/us-central1/operations/operation-1743320773669-6318a7f71b34f-81710c47-d5fcec1f","metadata":{"@type":"type.googleapis.com/google.cloud.functions.v2.OperationMetadata","createTime":"2025-03-30T07:46:14.558802814Z","endTime":"2025-03-30T07:46:52.918231116Z","target":"projects/ibotaniq/locations/us-central1/functions/api","verb":"update","cancelRequested":false,"apiVersion":"v2","requestResource":{"@type":"type.googleapis.com/google.cloud.functions.v2.Function","name":"projects/ibotaniq/locations/us-central1/functions/api","buildConfig":{"runtime":"nodejs18","entryPoint":"api","source":{"storageSource":{"bucket":"gcf-v2-sources-349395673351-us-central1","object":"api/function-source.zip","generation":"1743320774443524"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts","serviceAccount":"projects/ibotaniq/serviceAccounts/349395673351-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"serviceConfig":{"service":"projects/ibotaniq/locations/us-central1/services/api","timeoutSeconds":60,"environmentVariables":{"APP_PORT":"5000","DB_URI":"mongodb+srv://pavlasplichal:novy22projekt@cluster0.dplz2.mongodb.net/malina?retryWrites=true&w=majority","FIREBASE_CONFIG":"{\"projectId\":\"ibotaniq\",\"storageBucket\":\"ibotaniq.firebasestorage.app\"}","GCLOUD_PROJECT":"ibotaniq","EVENTARC_CLOUD_EVENT_SOURCE":"projects/ibotaniq/locations/us-central1/services/api","FUNCTION_TARGET":"api","LOG_EXECUTION_ID":"true"},"ingressSettings":"ALLOW_ALL","serviceAccountEmail":"349395673351-compute@developer.gserviceaccount.com","availableMemory":"256Mi","allTrafficOnLatestRevision":true,"revision":"api-00001-rex","maxInstanceRequestConcurrency":80,"availableCpu":"1"},"state":"ACTIVE","labels":{"deployment-tool":"cloudfunctions","firebase-functions-hash":"2260639d8529a91318d76047e453e57f8247cb60"},"environment":"GEN_2","url":"https://us-central1-ibotaniq.cloudfunctions.net/api","satisfiesPzi":true},"stages":[{"name":"SERVICE","state":"NOT_STARTED"}],"operationType":"UPDATE_FUNCTION"},"done":true,"error":{"code":3,"message":"Build failed with status: FAILURE and message: npm error code EUSAGE\nnpm error\nnpm error `npm ci` can only install packages when your package.json and package-lock.json or npm-shrinkwrap.json are in sync. Please update your lock file with `npm install` before continuing.\nnpm error\nnpm error Invalid: lock file's firebase-functions@6.3.2 does not satisfy firebase-functions@4.9.0\nnpm error Missing: @types/express@4.17.3 from lock file\nnpm error\nnpm error Clean install a project\nnpm error\nnpm error Usage:\nnpm error npm ci\nnpm error\nnpm error Options:\nnpm error [--install-strategy <hoisted|nested|shallow|linked>] [--legacy-bundling]\nnpm error [--global-style] [--omit <dev|optional|peer> [--omit <dev|optional|peer> ...]]\nnpm error [--include <prod|dev|optional|peer> [--include <prod|dev|optional|peer> ...]]\nnpm error [--strict-peer-deps] [--foreground-scripts] [--ignore-scripts] [--no-audit]\nnpm error [--no-bin-links] [--no-fund] [--dry-run]\nnpm error [-w|--workspace <workspace-name> [-w|--workspace <workspace-name> ...]]\nnpm error [-ws|--workspaces] [--include-workspace-root] [--install-links]\nnpm error\nnpm error aliases: clean-install, ic, install-clean, isntall-clean\nnpm error\nnpm error Run \"npm help ci\" for more info\nnpm error A complete log of this run can be found in: /www-data-home/.npm/_logs/2025-03-30T07_46_34_394Z-debug-0.log. For more details see the logs at https://console.cloud.google.com/cloud-build/builds;region=us-central1/fa1431a1-c683-4930-83b0-cc9b847c65d6?project=349395673351."}}
[debug] [2025-03-30T07:46:56.552Z] Got source token undefined for region us-central1
[error] Build failed with status: FAILURE and message: npm error code EUSAGE
npm error
npm error `npm ci` can only install packages when your package.json and package-lock.json or npm-shrinkwrap.json are in sync. Please update your lock file with `npm install` before continuing.
npm error
npm error Invalid: lock file's firebase-functions@6.3.2 does not satisfy firebase-functions@4.9.0
npm error Missing: @types/express@4.17.3 from lock file
npm error
npm error Clean install a project
npm error
npm error Usage:
npm error npm ci
npm error
npm error Options:
npm error [--install-strategy <hoisted|nested|shallow|linked>] [--legacy-bundling]
npm error [--global-style] [--omit <dev|optional|peer> [--omit <dev|optional|peer> ...]]
npm error [--include <prod|dev|optional|peer> [--include <prod|dev|optional|peer> ...]]
npm error [--strict-peer-deps] [--foreground-scripts] [--ignore-scripts] [--no-audit]
npm error [--no-bin-links] [--no-fund] [--dry-run]
npm error [-w|--workspace <workspace-name> [-w|--workspace <workspace-name> ...]]
npm error [-ws|--workspaces] [--include-workspace-root] [--install-links]
npm error
npm error aliases: clean-install, ic, install-clean, isntall-clean
npm error
npm error Run "npm help ci" for more info
npm error A complete log of this run can be found in: /www-data-home/.npm/_logs/2025-03-30T07_46_34_394Z-debug-0.log. For more details see the logs at https://console.cloud.google.com/cloud-build/builds;region=us-central1/fa1431a1-c683-4930-83b0-cc9b847c65d6?project=349395673351.
[debug] [2025-03-30T07:46:56.557Z] Total Function Deployment time: 43893
[debug] [2025-03-30T07:46:56.557Z] 1 Functions Deployed
[debug] [2025-03-30T07:46:56.557Z] 1 Functions Errored
[debug] [2025-03-30T07:46:56.557Z] 0 Function Deployments Aborted
[debug] [2025-03-30T07:46:56.557Z] Average Function Deployment time: 43891
[info] 
[info] Functions deploy had errors with the following functions:
	api(us-central1)
[debug] [2025-03-30T07:46:56.923Z] Not printing URL for HTTPS function. Typically this means it didn't match a filter or we failed deployment
[debug] [2025-03-30T07:46:56.924Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:56.925Z] Checked if tokens are valid: true, expires at: 1743324344658
[debug] [2025-03-30T07:46:56.925Z] >>> [apiv2][query] GET https://artifactregistry.googleapis.com/v1/projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts [none]
[debug] [2025-03-30T07:46:57.892Z] <<< [apiv2][status] GET https://artifactregistry.googleapis.com/v1/projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts 200
[debug] [2025-03-30T07:46:57.892Z] <<< [apiv2][body] GET https://artifactregistry.googleapis.com/v1/projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts {"name":"projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts","format":"DOCKER","description":"This repository is created and used by Cloud Functions for storing function docker images.","labels":{"goog-managed-by":"cloudfunctions"},"createTime":"2025-03-28T10:18:46.501773Z","updateTime":"2025-03-29T13:49:21.223150Z","mode":"STANDARD_REPOSITORY","cleanupPolicies":{"firebase-functions-cleanup":{"id":"firebase-functions-cleanup","action":"DELETE","condition":{"tagState":"ANY","olderThan":"86400s"}}},"vulnerabilityScanningConfig":{"lastEnableTime":"2025-03-28T10:18:38.025759054Z","enablementState":"SCANNING_DISABLED","enablementStateReason":"API containerscanning.googleapis.com is not enabled."},"satisfiesPzi":true,"registryUri":"us-central1-docker.pkg.dev/ibotaniq/gcf-artifacts"}
[debug] [2025-03-30T07:46:57.892Z] Functions deploy failed.
[debug] [2025-03-30T07:46:57.892Z] {
  "endpoint": {
    "id": "api",
    "project": "ibotaniq",
    "region": "us-central1",
    "entryPoint": "api",
    "platform": "gcfv2",
    "runtime": "nodejs18",
    "httpsTrigger": {},
    "labels": {
      "deployment-tool": "cli-firebase"
    },
    "serviceAccount": null,
    "ingressSettings": null,
    "timeoutSeconds": 60,
    "maxInstances": null,
    "minInstances": null,
    "concurrency": 80,
    "vpc": null,
    "environmentVariables": {
      "APP_PORT": "5000",
      "DB_URI": "mongodb+srv://pavlasplichal:novy22projekt@cluster0.dplz2.mongodb.net/malina?retryWrites=true&w=majority",
      "FIREBASE_CONFIG": "{\"projectId\":\"ibotaniq\",\"storageBucket\":\"ibotaniq.firebasestorage.app\"}",
      "GCLOUD_PROJECT": "ibotaniq",
      "EVENTARC_CLOUD_EVENT_SOURCE": "projects/ibotaniq/locations/us-central1/services/api"
    },
    "codebase": "default",
    "runServiceId": "api",
    "availableMemoryMb": 256,
    "cpu": 1,
    "securityLevel": "SECURE_ALWAYS",
    "targetedByOnly": false,
    "hash": "2260639d8529a91318d76047e453e57f8247cb60"
  },
  "op": "update",
  "original": {
    "name": "FirebaseError",
    "children": [],
    "exit": 1,
    "message": "Build failed with status: FAILURE and message: npm error code EUSAGE\nnpm error\nnpm error `npm ci` can only install packages when your package.json and package-lock.json or npm-shrinkwrap.json are in sync. Please update your lock file with `npm install` before continuing.\nnpm error\nnpm error Invalid: lock file's firebase-functions@6.3.2 does not satisfy firebase-functions@4.9.0\nnpm error Missing: @types/express@4.17.3 from lock file\nnpm error\nnpm error Clean install a project\nnpm error\nnpm error Usage:\nnpm error npm ci\nnpm error\nnpm error Options:\nnpm error [--install-strategy <hoisted|nested|shallow|linked>] [--legacy-bundling]\nnpm error [--global-style] [--omit <dev|optional|peer> [--omit <dev|optional|peer> ...]]\nnpm error [--include <prod|dev|optional|peer> [--include <prod|dev|optional|peer> ...]]\nnpm error [--strict-peer-deps] [--foreground-scripts] [--ignore-scripts] [--no-audit]\nnpm error [--no-bin-links] [--no-fund] [--dry-run]\nnpm error [-w|--workspace <workspace-name> [-w|--workspace <workspace-name> ...]]\nnpm error [-ws|--workspaces] [--include-workspace-root] [--install-links]\nnpm error\nnpm error aliases: clean-install, ic, install-clean, isntall-clean\nnpm error\nnpm error Run \"npm help ci\" for more info\nnpm error A complete log of this run can be found in: /www-data-home/.npm/_logs/2025-03-30T07_46_34_394Z-debug-0.log. For more details see the logs at https://console.cloud.google.com/cloud-build/builds;region=us-central1/fa1431a1-c683-4930-83b0-cc9b847c65d6?project=349395673351.",
    "original": {
      "code": 3,
      "message": "Build failed with status: FAILURE and message: npm error code EUSAGE\nnpm error\nnpm error `npm ci` can only install packages when your package.json and package-lock.json or npm-shrinkwrap.json are in sync. Please update your lock file with `npm install` before continuing.\nnpm error\nnpm error Invalid: lock file's firebase-functions@6.3.2 does not satisfy firebase-functions@4.9.0\nnpm error Missing: @types/express@4.17.3 from lock file\nnpm error\nnpm error Clean install a project\nnpm error\nnpm error Usage:\nnpm error npm ci\nnpm error\nnpm error Options:\nnpm error [--install-strategy <hoisted|nested|shallow|linked>] [--legacy-bundling]\nnpm error [--global-style] [--omit <dev|optional|peer> [--omit <dev|optional|peer> ...]]\nnpm error [--include <prod|dev|optional|peer> [--include <prod|dev|optional|peer> ...]]\nnpm error [--strict-peer-deps] [--foreground-scripts] [--ignore-scripts] [--no-audit]\nnpm error [--no-bin-links] [--no-fund] [--dry-run]\nnpm error [-w|--workspace <workspace-name> [-w|--workspace <workspace-name> ...]]\nnpm error [-ws|--workspaces] [--include-workspace-root] [--install-links]\nnpm error\nnpm error aliases: clean-install, ic, install-clean, isntall-clean\nnpm error\nnpm error Run \"npm help ci\" for more info\nnpm error A complete log of this run can be found in: /www-data-home/.npm/_logs/2025-03-30T07_46_34_394Z-debug-0.log. For more details see the logs at https://console.cloud.google.com/cloud-build/builds;region=us-central1/fa1431a1-c683-4930-83b0-cc9b847c65d6?project=349395673351."
    },
    "status": 3,
    "code": 3
  }
}
[debug] [2025-03-30T07:46:57.958Z] Error: Failed to update function api in region us-central1
    at C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:399:19
    at process.processTicksAndRejections (node:internal/process/task_queues:95:5)
    at async Fabricator.updateV2Function (C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:388:32)
    at async Fabricator.updateEndpoint (C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:155:13)
    at async handle (C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:89:17)
[error] 
[error] Error: There was an error deploying functions
