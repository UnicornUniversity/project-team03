[debug] [2025-03-28T10:42:38.585Z] ----------------------------------------------------------------------
[debug] [2025-03-28T10:42:38.587Z] Command:       C:\Program Files\nodejs\node.exe C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\bin\firebase.js deploy --only functions --project ibotaniq
[debug] [2025-03-28T10:42:38.588Z] CLI Version:   14.0.0
[debug] [2025-03-28T10:42:38.588Z] Platform:      win32
[debug] [2025-03-28T10:42:38.588Z] Node Version:  v20.11.1
[debug] [2025-03-28T10:42:38.588Z] Time:          Fri Mar 28 2025 11:42:38 GMT+0100 (středoevropský standardní čas)
[debug] [2025-03-28T10:42:38.588Z] ----------------------------------------------------------------------
[debug] 
[debug] [2025-03-28T10:42:38.747Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-03-28T10:42:38.748Z] > authorizing via signed-in user (pavlasplichal@gmail.com)
[debug] [2025-03-28T10:42:38.748Z] [iam] checking project ibotaniq for permissions ["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]
[debug] [2025-03-28T10:42:38.749Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:38.749Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:38.750Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions [none]
[debug] [2025-03-28T10:42:38.750Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-28T10:42:38.750Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-03-28T10:42:39.627Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions 200
[debug] [2025-03-28T10:42:39.627Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions {"permissions":["cloudfunctions.functions.create","cloudfunctions.functions.delete","cloudfunctions.functions.get","cloudfunctions.functions.list","cloudfunctions.functions.update","cloudfunctions.operations.get","firebase.projects.get"]}
[debug] [2025-03-28T10:42:39.627Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:39.628Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:39.628Z] >>> [apiv2][query] POST https://iam.googleapis.com/v1/projects/ibotaniq/serviceAccounts/ibotaniq@appspot.gserviceaccount.com:testIamPermissions [none]
[debug] [2025-03-28T10:42:39.628Z] >>> [apiv2][body] POST https://iam.googleapis.com/v1/projects/ibotaniq/serviceAccounts/ibotaniq@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[debug] [2025-03-28T10:42:40.096Z] <<< [apiv2][status] POST https://iam.googleapis.com/v1/projects/ibotaniq/serviceAccounts/ibotaniq@appspot.gserviceaccount.com:testIamPermissions 200
[debug] [2025-03-28T10:42:40.096Z] <<< [apiv2][body] POST https://iam.googleapis.com/v1/projects/ibotaniq/serviceAccounts/ibotaniq@appspot.gserviceaccount.com:testIamPermissions {"permissions":["iam.serviceAccounts.actAs"]}
[info] 
[info] === Deploying to 'ibotaniq'...
[info] 
[info] i  deploying functions 
[debug] [2025-03-28T10:42:40.099Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:40.099Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:40.099Z] >>> [apiv2][query] GET https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq [none]
[debug] [2025-03-28T10:42:40.355Z] <<< [apiv2][status] GET https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq 200
[debug] [2025-03-28T10:42:40.355Z] <<< [apiv2][body] GET https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq {"projectNumber":"349395673351","projectId":"ibotaniq","lifecycleState":"ACTIVE","name":"iBotaniQ","labels":{"firebase":"enabled","firebase-core":"disabled"},"createTime":"2025-03-15T19:55:18.615791Z"}
[info] i  functions: preparing codebase default for deployment 
[info] i  functions: ensuring required API cloudfunctions.googleapis.com is enabled... 
[debug] [2025-03-28T10:42:40.356Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:40.357Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:40.357Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:40.357Z] Checked if tokens are valid: true, expires at: 1743161179136
[info] i  functions: ensuring required API cloudbuild.googleapis.com is enabled... 
[debug] [2025-03-28T10:42:40.357Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:40.357Z] Checked if tokens are valid: true, expires at: 1743161179136
[info] i  artifactregistry: ensuring required API artifactregistry.googleapis.com is enabled... 
[debug] [2025-03-28T10:42:40.357Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:40.357Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:40.357Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudfunctions.googleapis.com [none]
[debug] [2025-03-28T10:42:40.358Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudfunctions.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-28T10:42:40.358Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/runtimeconfig.googleapis.com [none]
[debug] [2025-03-28T10:42:40.359Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/runtimeconfig.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-28T10:42:40.360Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudbuild.googleapis.com [none]
[debug] [2025-03-28T10:42:40.360Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudbuild.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-28T10:42:40.360Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/artifactregistry.googleapis.com [none]
[debug] [2025-03-28T10:42:40.361Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/artifactregistry.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-28T10:42:41.417Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/artifactregistry.googleapis.com 200
[debug] [2025-03-28T10:42:41.417Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/artifactregistry.googleapis.com [omitted]
[info] +  artifactregistry: required API artifactregistry.googleapis.com is enabled 
[debug] [2025-03-28T10:42:41.418Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudbuild.googleapis.com 200
[debug] [2025-03-28T10:42:41.418Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudbuild.googleapis.com [omitted]
[info] +  functions: required API cloudbuild.googleapis.com is enabled 
[debug] [2025-03-28T10:42:41.419Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudfunctions.googleapis.com 200
[debug] [2025-03-28T10:42:41.419Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/cloudfunctions.googleapis.com [omitted]
[info] +  functions: required API cloudfunctions.googleapis.com is enabled 
[debug] [2025-03-28T10:42:41.419Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/runtimeconfig.googleapis.com 200
[debug] [2025-03-28T10:42:41.420Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/runtimeconfig.googleapis.com [omitted]
[debug] [2025-03-28T10:42:41.420Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:41.420Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:41.420Z] >>> [apiv2][query] GET https://firebase.googleapis.com/v1beta1/projects/ibotaniq/adminSdkConfig [none]
[debug] [2025-03-28T10:42:41.899Z] <<< [apiv2][status] GET https://firebase.googleapis.com/v1beta1/projects/ibotaniq/adminSdkConfig 200
[debug] [2025-03-28T10:42:41.899Z] <<< [apiv2][body] GET https://firebase.googleapis.com/v1beta1/projects/ibotaniq/adminSdkConfig {"projectId":"ibotaniq","storageBucket":"ibotaniq.firebasestorage.app"}
[debug] [2025-03-28T10:42:41.900Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:41.901Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:41.901Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs [none]
[debug] [2025-03-28T10:42:42.790Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs 200
[debug] [2025-03-28T10:42:42.790Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs {"configs":[{"name":"projects/ibotaniq/configs/app"},{"name":"projects/ibotaniq/configs/mongodb"}]}
[debug] [2025-03-28T10:42:42.790Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:42.790Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:42.791Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:42.791Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:42.791Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/app/variables [none]
[debug] [2025-03-28T10:42:42.791Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables [none]
[debug] [2025-03-28T10:42:43.000Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/app/variables 200
[debug] [2025-03-28T10:42:43.001Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/app/variables {"variables":[{"name":"projects/ibotaniq/configs/app/variables/port","updateTime":"2025-03-28T10:41:39.708645567Z"}]}
[debug] [2025-03-28T10:42:43.001Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:43.001Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:43.001Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/app/variables/port [none]
[debug] [2025-03-28T10:42:43.245Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables 200
[debug] [2025-03-28T10:42:43.246Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables {"variables":[{"name":"projects/ibotaniq/configs/mongodb/variables/uri","updateTime":"2025-03-28T10:42:12.966146213Z"}]}
[debug] [2025-03-28T10:42:43.246Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:43.246Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:43.246Z] >>> [apiv2][query] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables/uri [none]
[debug] [2025-03-28T10:42:43.247Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/app/variables/port 200
[debug] [2025-03-28T10:42:43.247Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/app/variables/port {"name":"projects/ibotaniq/configs/app/variables/port","updateTime":"2025-03-28T10:41:39.708645567Z","text":"5000"}
[debug] [2025-03-28T10:42:43.469Z] <<< [apiv2][status] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables/uri 200
[debug] [2025-03-28T10:42:43.469Z] <<< [apiv2][body] GET https://runtimeconfig.googleapis.com/v1beta1/projects/ibotaniq/configs/mongodb/variables/uri {"name":"projects/ibotaniq/configs/mongodb/variables/uri","updateTime":"2025-03-28T10:42:12.966146213Z","text":"mongodb+srv://pavlasplichal:novy22projekt@cluster0.dplz2.mongodb.net/malina?retryWrites=true&w=majority"}
[debug] [2025-03-28T10:42:43.471Z] Validating nodejs source
[warn] !  functions: Runtime Node.js 18 will be deprecated on 2025-04-30 and will be decommissioned on 2025-10-31, after which you will not be able to deploy without upgrading. Consider upgrading now to avoid disruption. See https://cloud.google.com/functions/docs/runtime-support for full details on the lifecycle policy 
[debug] [2025-03-28T10:42:44.883Z] > [functions] package.json contents: {
  "name": "server",
  "version": "1.0.0",
  "description": "",
  "main": "index.js",
  "scripts": {
    "start": "node index.js",
    "build": "tsc"
  },
  "engines": {
    "node": "18"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "cors": "^2.8.5",
    "dotenv": "^16.4.7",
    "express": "^4.21.2",
    "firebase-functions": "^6.3.2",
    "joi": "^17.13.3",
    "mongoose": "^8.13.0"
  }
}
[debug] [2025-03-28T10:42:44.883Z] Building nodejs source
[info] i  functions: Loading and analyzing source code for codebase default to determine what to deploy 
[debug] [2025-03-28T10:42:44.885Z] Could not find functions.yaml. Must use http discovery
[debug] [2025-03-28T10:42:44.891Z] Found firebase-functions binary at 'C:\Users\splic\ukol-iot\functions\node_modules\.bin\firebase-functions'
[info] Serving at port 8334

[error] (node:17704) [MONGODB DRIVER] Warning: useNewUrlParser is a deprecated option: useNewUrlParser has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version
(Use `node --trace-warnings ...` to show where the warning was created)

[error] (node:17704) [MONGODB DRIVER] Warning: useUnifiedTopology is a deprecated option: useUnifiedTopology has no effect since Node.js Driver version 4.0.0 and will be removed in the next major version

[debug] [2025-03-28T10:42:45.790Z] Got response from /__/functions.yaml {"endpoints":{"api":{"availableMemoryMb":null,"timeoutSeconds":null,"minInstances":null,"maxInstances":null,"ingressSettings":null,"concurrency":null,"serviceAccountEmail":null,"vpc":null,"platform":"gcfv2","labels":{},"httpsTrigger":{},"entryPoint":"api"}},"specVersion":"v1alpha1","requiredAPIs":[],"extensions":{}}
[info] MongoDB connected

[info] i  extensions: ensuring required API firebaseextensions.googleapis.com is enabled... 
[debug] [2025-03-28T10:42:55.812Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:55.812Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:55.812Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/firebaseextensions.googleapis.com [none]
[debug] [2025-03-28T10:42:55.812Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/firebaseextensions.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-28T10:42:56.782Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/firebaseextensions.googleapis.com 200
[debug] [2025-03-28T10:42:56.783Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/firebaseextensions.googleapis.com [omitted]
[info] +  extensions: required API firebaseextensions.googleapis.com is enabled 
[debug] [2025-03-28T10:42:56.784Z] > command requires scopes: ["email","openid","https://www.googleapis.com/auth/cloudplatformprojects.readonly","https://www.googleapis.com/auth/firebase","https://www.googleapis.com/auth/cloud-platform"]
[debug] [2025-03-28T10:42:56.785Z] > authorizing via signed-in user (pavlasplichal@gmail.com)
[debug] [2025-03-28T10:42:56.785Z] [iam] checking project ibotaniq for permissions ["firebase.projects.get","firebaseextensions.instances.list"]
[debug] [2025-03-28T10:42:56.785Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:56.785Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:56.786Z] >>> [apiv2][query] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions [none]
[debug] [2025-03-28T10:42:56.786Z] >>> [apiv2][(partial)header] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-28T10:42:56.786Z] >>> [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions {"permissions":["firebase.projects.get","firebaseextensions.instances.list"]}
[debug] [2025-03-28T10:42:57.628Z] <<< [apiv2][status] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions 200
[debug] [2025-03-28T10:42:57.629Z] <<< [apiv2][body] POST https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq:testIamPermissions {"permissions":["firebase.projects.get","firebaseextensions.instances.list"]}
[debug] [2025-03-28T10:42:57.629Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:57.629Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:57.629Z] >>> [apiv2][query] GET https://firebaseextensions.googleapis.com/v1beta/projects/ibotaniq/instances pageSize=100&pageToken=
[debug] [2025-03-28T10:42:58.606Z] <<< [apiv2][status] GET https://firebaseextensions.googleapis.com/v1beta/projects/ibotaniq/instances 200
[debug] [2025-03-28T10:42:58.606Z] <<< [apiv2][body] GET https://firebaseextensions.googleapis.com/v1beta/projects/ibotaniq/instances {}
[info] i  functions: Loaded environment variables from .env. 
[info] i  functions: preparing functions directory for uploading... 
[info] i  functions: packaged C:\Users\splic\ukol-iot\functions (35.22 KB) for uploading 
[debug] [2025-03-28T10:42:58.650Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:58.650Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:58.650Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v1/projects/ibotaniq/locations/-/functions [none]
[debug] [2025-03-28T10:42:59.670Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v1/projects/ibotaniq/locations/-/functions 200
[debug] [2025-03-28T10:42:59.670Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v1/projects/ibotaniq/locations/-/functions {}
[debug] [2025-03-28T10:42:59.670Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:59.670Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:42:59.671Z] >>> [apiv2][query] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/-/functions filter=environment%3D%22GEN_2%22
[debug] [2025-03-28T10:43:00.751Z] <<< [apiv2][status] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/-/functions 200
[debug] [2025-03-28T10:43:00.751Z] <<< [apiv2][body] GET https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/-/functions {"functions":[{"name":"projects/ibotaniq/locations/us-central1/functions/api","buildConfig":{"build":"projects/349395673351/locations/us-central1/builds/a7dda590-1301-4fd8-bff8-aefd45b9918e","runtime":"nodejs18","entryPoint":"api","source":{"storageSource":{"bucket":"gcf-v2-sources-349395673351-us-central1","object":"api/function-source.zip","generation":"1743157117466836"}},"environmentVariables":{"GOOGLE_NODE_RUN_SCRIPTS":""},"dockerRepository":"projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts","sourceProvenance":{"resolvedStorageSource":{"bucket":"gcf-v2-sources-349395673351-us-central1","object":"api/function-source.zip","generation":"1743157117466836"}},"dockerRegistry":"ARTIFACT_REGISTRY","serviceAccount":"projects/ibotaniq/serviceAccounts/349395673351-compute@developer.gserviceaccount.com","automaticUpdatePolicy":{}},"state":"FAILED","updateTime":"2025-03-28T10:20:54.382364855Z","labels":{"deployment-tool":"cli-firebase","firebase-functions-hash":"057e3c580928440365468b7e603d9d8bbc99605f"},"stateMessages":[{"severity":"ERROR","type":"CloudRunServiceNotFound","message":"Cloud Run service projects/ibotaniq/locations/us-central1/services/api for the function was not found. The function will not work correctly. Please redeploy."}],"environment":"GEN_2","url":"https://us-central1-ibotaniq.cloudfunctions.net/api","createTime":"2025-03-28T10:18:37.827524970Z","satisfiesPzi":true}]}
[info] i  functions: ensuring required API run.googleapis.com is enabled... 
[debug] [2025-03-28T10:43:00.753Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:00.753Z] Checked if tokens are valid: true, expires at: 1743161179136
[info] i  functions: ensuring required API eventarc.googleapis.com is enabled... 
[debug] [2025-03-28T10:43:00.754Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:00.754Z] Checked if tokens are valid: true, expires at: 1743161179136
[info] i  functions: ensuring required API pubsub.googleapis.com is enabled... 
[debug] [2025-03-28T10:43:00.754Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:00.754Z] Checked if tokens are valid: true, expires at: 1743161179136
[info] i  functions: ensuring required API storage.googleapis.com is enabled... 
[debug] [2025-03-28T10:43:00.754Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:00.754Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:00.754Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/run.googleapis.com [none]
[debug] [2025-03-28T10:43:00.755Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/run.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-28T10:43:00.755Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/eventarc.googleapis.com [none]
[debug] [2025-03-28T10:43:00.755Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/eventarc.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-28T10:43:00.756Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/pubsub.googleapis.com [none]
[debug] [2025-03-28T10:43:00.756Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/pubsub.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-28T10:43:00.757Z] >>> [apiv2][query] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/storage.googleapis.com [none]
[debug] [2025-03-28T10:43:00.757Z] >>> [apiv2][(partial)header] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/storage.googleapis.com x-goog-quota-user=projects/ibotaniq
[debug] [2025-03-28T10:43:01.681Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/run.googleapis.com 200
[debug] [2025-03-28T10:43:01.681Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/run.googleapis.com [omitted]
[info] +  functions: required API run.googleapis.com is enabled 
[debug] [2025-03-28T10:43:01.739Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/pubsub.googleapis.com 200
[debug] [2025-03-28T10:43:01.739Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/pubsub.googleapis.com [omitted]
[info] +  functions: required API pubsub.googleapis.com is enabled 
[debug] [2025-03-28T10:43:01.763Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/eventarc.googleapis.com 200
[debug] [2025-03-28T10:43:01.763Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/eventarc.googleapis.com [omitted]
[info] +  functions: required API eventarc.googleapis.com is enabled 
[debug] [2025-03-28T10:43:01.777Z] <<< [apiv2][status] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/storage.googleapis.com 200
[debug] [2025-03-28T10:43:01.778Z] <<< [apiv2][body] GET https://serviceusage.googleapis.com/v1/projects/ibotaniq/services/storage.googleapis.com [omitted]
[info] +  functions: required API storage.googleapis.com is enabled 
[info] i  functions: generating the service identity for pubsub.googleapis.com... 
[debug] [2025-03-28T10:43:01.778Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:01.779Z] Checked if tokens are valid: true, expires at: 1743161179136
[info] i  functions: generating the service identity for eventarc.googleapis.com... 
[debug] [2025-03-28T10:43:01.779Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:01.779Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:01.779Z] >>> [apiv2][query] POST https://serviceusage.googleapis.com/v1beta1/projects/349395673351/services/pubsub.googleapis.com:generateServiceIdentity [none]
[debug] [2025-03-28T10:43:01.779Z] >>> [apiv2][query] POST https://serviceusage.googleapis.com/v1beta1/projects/349395673351/services/eventarc.googleapis.com:generateServiceIdentity [none]
[debug] [2025-03-28T10:43:02.201Z] <<< [apiv2][status] POST https://serviceusage.googleapis.com/v1beta1/projects/349395673351/services/pubsub.googleapis.com:generateServiceIdentity 200
[debug] [2025-03-28T10:43:02.201Z] <<< [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/349395673351/services/pubsub.googleapis.com:generateServiceIdentity {"name":"operations/finished.DONE_OPERATION","done":true,"response":{"@type":"type.googleapis.com/google.api.serviceusage.v1beta1.ServiceIdentity","email":"service-349395673351@gcp-sa-pubsub.iam.gserviceaccount.com","uniqueId":"107806887384018536333"}}
[debug] [2025-03-28T10:43:02.743Z] <<< [apiv2][status] POST https://serviceusage.googleapis.com/v1beta1/projects/349395673351/services/eventarc.googleapis.com:generateServiceIdentity 200
[debug] [2025-03-28T10:43:02.743Z] <<< [apiv2][body] POST https://serviceusage.googleapis.com/v1beta1/projects/349395673351/services/eventarc.googleapis.com:generateServiceIdentity {"name":"operations/finished.DONE_OPERATION","done":true,"response":{"@type":"type.googleapis.com/google.api.serviceusage.v1beta1.ServiceIdentity","email":"service-349395673351@gcp-sa-eventarc.iam.gserviceaccount.com","uniqueId":"118401887025608679041"}}
[debug] [2025-03-28T10:43:02.744Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:02.744Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:02.745Z] >>> [apiv2][query] GET https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq [none]
[debug] [2025-03-28T10:43:03.629Z] <<< [apiv2][status] GET https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq 200
[debug] [2025-03-28T10:43:03.630Z] <<< [apiv2][body] GET https://cloudresourcemanager.googleapis.com/v1/projects/ibotaniq {"projectNumber":"349395673351","projectId":"ibotaniq","lifecycleState":"ACTIVE","name":"iBotaniQ","labels":{"firebase":"enabled","firebase-core":"disabled"},"createTime":"2025-03-15T19:55:18.615791Z"}
[debug] [2025-03-28T10:43:03.630Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:03.630Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:03.630Z] >>> [apiv2][query] GET https://cloudbilling.googleapis.com/v1/projects/ibotaniq/billingInfo [none]
[debug] [2025-03-28T10:43:04.108Z] <<< [apiv2][status] GET https://cloudbilling.googleapis.com/v1/projects/ibotaniq/billingInfo 200
[debug] [2025-03-28T10:43:04.108Z] <<< [apiv2][body] GET https://cloudbilling.googleapis.com/v1/projects/ibotaniq/billingInfo {"name":"projects/ibotaniq/billingInfo","projectId":"ibotaniq","billingAccountName":"billingAccounts/01F2AB-41BBCC-E41816","billingEnabled":true}
[debug] [2025-03-28T10:43:04.109Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:04.109Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:04.109Z] >>> [apiv2][query] POST https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/functions:generateUploadUrl [none]
[debug] [2025-03-28T10:43:04.950Z] <<< [apiv2][status] POST https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/functions:generateUploadUrl 200
[debug] [2025-03-28T10:43:04.950Z] <<< [apiv2][body] POST https://cloudfunctions.googleapis.com/v2/projects/ibotaniq/locations/us-central1/functions:generateUploadUrl {"uploadUrl":"https://storage.googleapis.com/gcf-v2-uploads-349395673351.us-central1.cloudfunctions.appspot.com/ea28318d-af8b-4c6b-b993-05ea59f43131.zip?GoogleAccessId=service-349395673351@gcf-admin-robot.iam.gserviceaccount.com&Expires=1743160384&Signature=YquXy9VhTssSB9UKNN0poWGXkvUyhwnKEtPa7Cv83qaVbjIm2nrwNjsBUeQ0RgGkFQ8aNd8txOh0O9ZqpLsM8ocjkiNU0kbBdvJoJmbfeHsC%2BdeBiTtPj31G3xivarjJHztpkGSBaiKWh3E7vhU5jhR7lQwNX3fsI5X5ABRuoYw5YOVLBQxCPRSj9R40NV5EvfqeYM3MHw1jSJSALbE%2BU5lBHNNNYG1roiJL7GW%2FcZkpyOxQNbfrjBq1OLOr2xZhaobWVBwLksbfNrDhfB49AJXbS78nmLjLUGLVpiDPZan74%2FOupPLjWTNdHLDj3RPWKuxZtSLgerMuDGkzEkGegg%3D%3D","storageSource":{"bucket":"gcf-v2-uploads-349395673351.us-central1.cloudfunctions.appspot.com","object":"ea28318d-af8b-4c6b-b993-05ea59f43131.zip"}}
[debug] [2025-03-28T10:43:04.953Z] >>> [apiv2][query] PUT https://storage.googleapis.com/gcf-v2-uploads-349395673351.us-central1.cloudfunctions.appspot.com/ea28318d-af8b-4c6b-b993-05ea59f43131.zip GoogleAccessId=service-349395673351%40gcf-admin-robot.iam.gserviceaccount.com&Expires=1743160384&Signature=YquXy9VhTssSB9UKNN0poWGXkvUyhwnKEtPa7Cv83qaVbjIm2nrwNjsBUeQ0RgGkFQ8aNd8txOh0O9ZqpLsM8ocjkiNU0kbBdvJoJmbfeHsC%2BdeBiTtPj31G3xivarjJHztpkGSBaiKWh3E7vhU5jhR7lQwNX3fsI5X5ABRuoYw5YOVLBQxCPRSj9R40NV5EvfqeYM3MHw1jSJSALbE%2BU5lBHNNNYG1roiJL7GW%2FcZkpyOxQNbfrjBq1OLOr2xZhaobWVBwLksbfNrDhfB49AJXbS78nmLjLUGLVpiDPZan74%2FOupPLjWTNdHLDj3RPWKuxZtSLgerMuDGkzEkGegg%3D%3D
[debug] [2025-03-28T10:43:04.954Z] >>> [apiv2][body] PUT https://storage.googleapis.com/gcf-v2-uploads-349395673351.us-central1.cloudfunctions.appspot.com/ea28318d-af8b-4c6b-b993-05ea59f43131.zip [stream]
[debug] [2025-03-28T10:43:05.652Z] <<< [apiv2][status] PUT https://storage.googleapis.com/gcf-v2-uploads-349395673351.us-central1.cloudfunctions.appspot.com/ea28318d-af8b-4c6b-b993-05ea59f43131.zip 200
[debug] [2025-03-28T10:43:05.652Z] <<< [apiv2][body] PUT https://storage.googleapis.com/gcf-v2-uploads-349395673351.us-central1.cloudfunctions.appspot.com/ea28318d-af8b-4c6b-b993-05ea59f43131.zip [omitted]
[info] +  functions: functions folder uploaded successfully 
[info] i  functions: updating Node.js 18 (2nd Gen) function api(us-central1)... 
[debug] [2025-03-28T10:43:05.666Z] Total Function Deployment time: 2
[debug] [2025-03-28T10:43:05.666Z] 1 Functions Deployed
[debug] [2025-03-28T10:43:05.666Z] 1 Functions Errored
[debug] [2025-03-28T10:43:05.666Z] 0 Function Deployments Aborted
[debug] [2025-03-28T10:43:05.666Z] Average Function Deployment time: 0
[info] 
[info] Functions deploy had errors with the following functions:
	api(us-central1)
[debug] [2025-03-28T10:43:05.905Z] Not printing URL for HTTPS function. Typically this means it didn't match a filter or we failed deployment
[debug] [2025-03-28T10:43:05.906Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:05.906Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:05.906Z] >>> [apiv2][query] GET https://artifactregistry.googleapis.com/v1/projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts [none]
[debug] [2025-03-28T10:43:07.476Z] <<< [apiv2][status] GET https://artifactregistry.googleapis.com/v1/projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts 200
[debug] [2025-03-28T10:43:07.477Z] <<< [apiv2][body] GET https://artifactregistry.googleapis.com/v1/projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts {"name":"projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts","format":"DOCKER","description":"This repository is created and used by Cloud Functions for storing function docker images.","labels":{"goog-managed-by":"cloudfunctions"},"createTime":"2025-03-28T10:18:46.501773Z","updateTime":"2025-03-28T10:20:54.261652Z","mode":"STANDARD_REPOSITORY","sizeBytes":"88155682","vulnerabilityScanningConfig":{"lastEnableTime":"2025-03-28T10:18:38.025759054Z","enablementState":"SCANNING_DISABLED","enablementStateReason":"API containerscanning.googleapis.com is not enabled."},"satisfiesPzi":true,"registryUri":"us-central1-docker.pkg.dev/ibotaniq/gcf-artifacts"}
[warn] !  functions: No cleanup policy detected for repositories in us-central1. This may result in a small monthly bill as container images accumulate over time. 
[info] i  functions: Configuring cleanup policy for repository in us-central1. Images older than 1 days will be automatically deleted. 
[debug] [2025-03-28T10:43:18.137Z] Setting up artifact cleanup policy for region us-central1
[debug] [2025-03-28T10:43:18.137Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:18.137Z] Checked if tokens are valid: true, expires at: 1743161179136
[debug] [2025-03-28T10:43:18.137Z] >>> [apiv2][query] PATCH https://artifactregistry.googleapis.com/v1/projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts updateMask=name%2CcleanupPolicies%2Clabels
[debug] [2025-03-28T10:43:18.137Z] >>> [apiv2][body] PATCH https://artifactregistry.googleapis.com/v1/projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts {"name":"projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts","cleanupPolicies":{"firebase-functions-cleanup":{"id":"firebase-functions-cleanup","condition":{"tagState":"ANY","olderThan":"86400s"},"action":"DELETE"}},"labels":{"goog-managed-by":"cloudfunctions"}}
[debug] [2025-03-28T10:43:19.070Z] <<< [apiv2][status] PATCH https://artifactregistry.googleapis.com/v1/projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts 200
[debug] [2025-03-28T10:43:19.070Z] <<< [apiv2][body] PATCH https://artifactregistry.googleapis.com/v1/projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts {"name":"projects/ibotaniq/locations/us-central1/repositories/gcf-artifacts","format":"DOCKER","description":"This repository is created and used by Cloud Functions for storing function docker images.","labels":{"goog-managed-by":"cloudfunctions"},"createTime":"2025-03-28T10:18:46.501773Z","updateTime":"2025-03-28T10:43:18.769431Z","mode":"STANDARD_REPOSITORY","cleanupPolicies":{"firebase-functions-cleanup":{"id":"firebase-functions-cleanup","action":"DELETE","condition":{"tagState":"ANY","olderThan":"86400s"}}},"vulnerabilityScanningConfig":{"lastEnableTime":"2025-03-28T10:18:38.025759054Z","enablementState":"SCANNING_DISABLED","enablementStateReason":"API containerscanning.googleapis.com is not enabled."},"satisfiesPzi":true}
[info] i  functions: Configured cleanup policy for repository in us-central1. 
[debug] [2025-03-28T10:43:19.070Z] Functions deploy failed.
[debug] [2025-03-28T10:43:19.070Z] {}
[debug] [2025-03-28T10:43:19.270Z] TypeError: Cannot read properties of null (reading 'length')
    at Object.formatServiceAccount (C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\gcp\proto.js:95:24)
    at C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\gcp\cloudfunctionsv2.js:196:122
    at Object.convertIfPresent (C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\gcp\proto.js:45:25)
    at Object.functionFromEndpoint (C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\gcp\cloudfunctionsv2.js:196:11)
    at Fabricator.updateV2Function (C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:384:35)
    at Fabricator.updateEndpoint (C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:155:24)
    at C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:110:71
    at handle (C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:89:23)
    at Fabricator.applyChangeset (C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:110:26)
    at C:\Users\splic\AppData\Roaming\npm\node_modules\firebase-tools\lib\deploy\functions\release\fabricator.js:69:40
[error] 
[error] Error: There was an error deploying functions
